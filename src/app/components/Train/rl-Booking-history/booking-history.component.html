<ion-app>
  <ion-header [translucent]="true">
    <ion-toolbar class="ion-text-center">
      <ion-buttons slot="start" style="background-color: #287aff;">
        <ion-menu-button style="color: rgb(255, 255, 255);"></ion-menu-button>
    </ion-buttons>
      <ion-row>
        <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" size-xl="12">
          <span class="h1">
            <ion-icon name="train"></ion-icon> Rail Booking History
          </span>
        </ion-col>
      </ion-row>
    </ion-toolbar>
  </ion-header>
  <ion-content style="background-color: white;">
    <ion-card class="ion-margin-top" style="background-color: white;">
      <ion-grid>
        <ion-row>
          <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" size-xl="12" class="ion-padding">
            <form [formGroup]="agtLstGP" (ngSubmit)="AgtSrhBtn($event)">
              <ion-row class="bdr ion-padding">

                <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" size-xl="12">
                  <ion-radio-group value="Date">
                    <ion-radio value="Id" (click)="AgentActive()"></ion-radio>
                    <ion-label class="R-label">Agent Id</ion-label>
                    <ion-radio value="Date" (click)="DateActive()"></ion-radio>
                    <ion-label class="R-label">Date Wise</ion-label>
                  </ion-radio-group>
                </ion-col>
                <ion-col size-xs="12" size-sm="12" size-md="2" size-lg="2" size-xl="2">
                  <fieldset [disabled]="!dateDis">
                    <input formControlName="RAID" maxlength="8" min="8" placeholder="Agent ID" (keydown)="btnActive()">
                  </fieldset>
                </ion-col>
                <ion-col size-xs="6" size-sm="6" size-md="2" size-lg="2" size-xl="2">
                  <fieldset>
                    <input formControlName="FROM" type="date" [max]="maxDate" (change)="btnActive()">
                  </fieldset>
                </ion-col>
                <ion-col size-xs="6" size-sm="6" size-md="2" size-lg="2" size-xl="2">
                  <fieldset>
                    <input formControlName="TO" type="date" [max]="maxDate" (change)="btnActive()">
                  </fieldset>
                </ion-col>

                <ion-col size-xs="12" size-sm="12" size-md="3" size-lg="3" size-xl="3">
                  <button class="ccL-btn" type="submit" [disabled]="btn">
                    <ion-icon slot="start" name="search"></ion-icon> Search
                  </button>
                </ion-col>

                <ion-col size-xs="12" size-sm="12" size-md="3" size-lg="3" size-xl="3" class="ion-text-end">
                  <ion-label class="pdn">Production</ion-label>
                  <ion-toggle (click)="toggle()"></ion-toggle>
                  <ion-label>Development</ion-label>
                </ion-col>
              </ion-row>
            </form>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-card>

    <ion-row *ngIf="tabShow" style="padding: 0px;">
      <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" size-xl="12">
        <ion-badge color="primary" style="margin: 5px 0px 0px 15px;">Total Result = {{agtList.length}}</ion-badge>
       
        <ion-badge color="success" style="margin-left: 20px; " class="ionp">Total Booking Amount = {{this.amt |
          currency:'INR'}}</ion-badge>
        <ion-badge color="tertiary" class="ionp" style="cursor: pointer;float: right;margin: 5px 20px 0px 0px;" (click)="exportexcel()">
          <img src="https://img.icons8.com/material-outlined/12/ffffff/download--v1.png" /> Download Excel
        </ion-badge>
        <ion-badge color="danger" class="ionp" style="cursor: pointer;float: right;margin: 5px 20px 0px 0px;" (click)="openPDF()">
          <img src="https://img.icons8.com/material-outlined/12/ffffff/download--v1.png" /> Download Pdf
        </ion-badge>
        <!-- <ion-badge color="secondary" class="ionp" style="cursor: pointer;float: right;margin: 5px 20px 0px 0px;" (click)="exportexcel()">
          <img src="https://img.icons8.com/material-outlined/12/ffffff/download--v1.png" /> Download Text
        </ion-badge> -->
      </ion-col>
    </ion-row>
    <ion-card class="" *ngIf="tabShow"
      style="overflow-x:auto; background-color: white; padding-bottom: 90px; ">
   
      <table id="tabl" #tabl>
        <thead >
          <tr>
            <th class="padding">
              #
            </th>
            <th class="padding">
              Booking Id
            </th>
            <th class="padding">
              Email Id
              <ion-icon name="caret-down-outline" *ngIf="down1" (click)="sortMailAsc()"
                style="cursor: pointer; color: red;"></ion-icon>
              <ion-icon name="caret-up-outline" *ngIf="up1" (click)="sortMailDesc()"
                style="cursor: pointer; color: red;"></ion-icon>
            </th>
            <th class="padding">
              FID
            </th>
            <th class="padding">
              RID
            </th>
            <th class="padding">
              PNR
            </th>
            <th class="padding">
              Amount
              <ion-icon name="caret-down-outline" *ngIf="down" (click)="sortBalAsc()"
                style="cursor: pointer; color: red;"></ion-icon>
              <ion-icon name="caret-up-outline" *ngIf="up" (click)="sortBalDesc()" style="cursor: pointer; color: red;">
              </ion-icon>
            </th>
            <!-- <th class="padding">
              Status
            </th> -->
            <!-- <th class="padding">
              Dep Date
            </th> -->
            <th class="padding">
              Time
              <ion-icon name="caret-down-outline" *ngIf="down2" (click)="sortDateAsc()"
                style="cursor: pointer; color: red;"></ion-icon>
              <ion-icon name="caret-up-outline" *ngIf="up2" (click)="sortDateDesc()"
                style="cursor: pointer; color: red;"></ion-icon>
            </th>
            <th class="padding">
              Action
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let d of agtList, index as i" class="hvr">
            <td >{{i+1}}</td>
            <!-- <td class="ion-text-center" style="color: red;cursor: pointer" (click)="PNR(d)">{{d.BOOKING_ID}}</td> -->
            <td  *ngIf="d.PNR!==''" style="color: rgb(255, 0, 0); cursor: pointer"
              (click)="PNR(d)">
              <b>{{d.BOOKING_ID|uppercase}}</b>
            </td>
            <!-- <td class="ion-text-center" *ngIf="d.PNR==''" style="cursor: pointer" (click)="PNR(d)">
              {{d.BOOKING_ID|uppercase}}
            </td> -->
            <td>{{d.EMAIL_ID}}</td>
            <td  style="color: rgb(57, 47, 241);">{{d.FID}}</td>
            <td  style="color: rgb(196, 47, 241);">{{d.RID}}</td>
            <td  style="color: rgb(8, 144, 255);"><b>{{d.PNR}}</b></td>
            <td  style="color: green;"><b>{{d.AMOUNT | currency:'INR'}}</b></td>
            <!-- <td class="ion-text-center"><span [style.background-color]="d.STATUS==false ? 'red' : 'green'"
                class="dot"></span></td> -->
            <!-- <td class="ion-text-center">{{d.DEP_DATE | date: 'dd/MM/yyyy'}}</td> -->
            <td >{{d.ETIME | date: 'dd/MM/yyyy'}} / {{d.ETIME | date:"HH:mm"}}</td>
            <td class="">
              <div class="popover__wrapper ">
                <!-- <ion-button color="primary" size="small">
                  ACTION
                </ion-button> -->
                <ion-badge color="primary" class="ionp font">ACTION</ion-badge>
                <div class="popover__content ">
                  <button matTooltip="Transaction History" matTooltipPosition="left"
                    matTooltipClass="example-tooltip-red" class="example-button">
                    <img src="https://img.icons8.com/small/24/4a90e2/activity-history.png" (click)="tHist(d)" />
                  </button><br>
                  <button matTooltip="Pnr Status" matTooltipPosition="left" matTooltipClass="example-tooltip-red"
                    class="example-button">
                    <img src="https://img.icons8.com/small/24/fa314a/data-pending.png" (click)="pStatus(d)" />
                  </button><br>
                  <button matTooltip="Refund Status" matTooltipPosition="left" matTooltipClass="example-tooltip-red"
                    class="example-button">
                    <img src="https://img.icons8.com/color/24/000000/refund.png" (click)="rStatus(d)" />
                  </button>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>    
    </ion-card>

    <ion-card *ngIf="dog" class="ion-text-center"  style="background-color: #ffffff;">
      <img src="../../../assets/404.gif">
    </ion-card>
  </ion-content>
</ion-app>